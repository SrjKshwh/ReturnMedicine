{% extends "base.html" %}

{% block content %}
<div class="row">
    <div class="col-12">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h1 class="h3">Checks</h1>
            <a href="{{ url_for('dashboard') }}" class="btn btn-secondary">Back to Dashboard</a>
        </div>
        <div class="alert alert-info">
            <h5>How to use this page:</h5>
            <p>This page displays a list of all check statements in the system. Use the search and filter options to find specific checks by statement number or check number. The table shows payment information including payment date, check amount, check number, and processing status. Click "View Details" to see the individual return numbers and amounts associated with each check statement.</p>
        </div>

        <!-- Search Filters -->
        <div class="card mb-4">
            <div class="card-header">
                <h5 class="mb-0">Search & Filter Checks</h5>
            </div>
            <div class="card-body">
                <form method="GET" class="row g-3">
                    <div class="col-md-4">
                        <label for="statement_no" class="form-label">Statement #</label>
                        <input type="text" class="form-control" id="statement_no" name="statement_no" value="{{ statement_no }}">
                    </div>
                    <div class="col-md-4">
                        <label for="check_no" class="form-label">Check #</label>
                        <input type="text" class="form-control" id="check_no" name="check_no" value="{{ check_no }}">
                    </div>
                    <div class="col-md-4 d-flex align-items-end">
                        <button type="submit" class="btn btn-primary me-2">Search</button>
                        <a href="{{ url_for('checks') }}" class="btn btn-outline-secondary">Clear</a>
                    </div>
                </form>
            </div>
        </div>

        {% if checks %}
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0">Check Statements ({{ checks|length }})</h5>
            </div>
            <div class="card-body p-0">
                <div class="table-responsive">
                    <table class="table table-hover mb-0">
                        <thead class="table-light">
                            <tr>
                                <th>Statement #</th>
                                <th>Payment Date</th>
                                <th>Check Amount</th>
                                <th>Check #</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for check in checks %}
                            <tr>
                                <td>{{ check.statement_no }}</td>
                                <td>{{ check.payment_date.strftime('%Y-%m-%d') }}</td>
                                <td>${{ "%.2f"|format(check.check_amount) }}</td>
                                <td>{{ check.check_no }}</td>
                                <td>
                                    <span class="badge
                                        {% if check.status == 'Pending' %}bg-warning
                                        {% elif check.status == 'Processed' %}bg-success
                                        {% else %}bg-light text-dark{% endif %}">
                                        {{ check.status }}
                                    </span>
                                </td>
                                <td>
                                    <a href="{{ url_for('check_details', id=check.id) }}" class="btn btn-sm btn-outline-primary">View Details</a>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        {% else %}
        <div class="card text-center p-5">
            <div class="card-body">
                <h5 class="card-title">No Checks Found</h5>
                <p class="card-text">No check statements match your search criteria.</p>
                <a href="{{ url_for('checks') }}" class="btn btn-primary">Clear Filters</a>
            </div>
        </div>
        {% endif %}
    </div>
</div>
{% endblock %}
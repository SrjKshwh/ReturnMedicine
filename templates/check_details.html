{% extends "base.html" %}

{% block content %}
<div class="row">
    <div class="col-12">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h1 class="h3">Check Details: {{ check_statement.statement_no }}</h1>
            <a href="{{ url_for('checks') }}" class="btn btn-secondary">Back to Checks</a>
        </div>
        <div class="alert alert-info">
            <h5>How to use this page:</h5>
            <p>This page shows detailed information for a specific check statement. View the check statement summary including payment date, check amount, check number, and processing status. The check details table lists all return numbers and amounts associated with this check, along with links to view any attached PDF files. This helps track which returns are covered by each payment.</p>
        </div>

        <!-- Check Statement Details -->
        <div class="card mb-4">
            <div class="card-header">
                <h5 class="mb-0">Check Statement Information</h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6">
                        <p><strong>Statement #:</strong> {{ check_statement.statement_no }}</p>
                        <p><strong>Payment Date:</strong> {{ check_statement.payment_date.strftime('%Y-%m-%d') }}</p>
                        <p><strong>Check Amount:</strong> ${{ "%.2f"|format(check_statement.check_amount) }}</p>
                    </div>
                    <div class="col-md-6">
                        <p><strong>Check #:</strong> {{ check_statement.check_no }}</p>
                        <p><strong>Status:</strong>
                            <span class="badge
                                {% if check_statement.status == 'Pending' %}bg-warning
                                {% elif check_statement.status == 'Processed' %}bg-success
                                {% else %}bg-light text-dark{% endif %}">
                                {{ check_statement.status }}
                            </span>
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Check Details -->
        {% if details %}
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0">Check Details</h5>
            </div>
            <div class="card-body p-0">
                <div class="table-responsive">
                    <table class="table table-hover mb-0">
                        <thead class="table-light">
                            <tr>
                                <th>Return #</th>
                                <th>Amount</th>
                                <th>PDF</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for detail in details %}
                            <tr>
                                <td>{{ detail.return_no }}</td>
                                <td>${{ "%.2f"|format(detail.amount) }}</td>
                                <td>
                                    {% if detail.pdf_file %}
                                        <a href="{{ url_for('static', filename=detail.pdf_file) }}" target="_blank" class="btn btn-sm btn-outline-primary">
                                            <i class="fas fa-file-pdf"></i> View PDF
                                        </a>
                                    {% else %}
                                        <em>No PDF</em>
                                    {% endif %}
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        {% else %}
        <div class="card text-center p-5">
            <div class="card-body">
                <h5 class="card-title">No Details Available</h5>
                <p class="card-text">No check details available for this statement.</p>
            </div>
        </div>
        {% endif %}
    </div>
</div>
{% endblock %}